<!DOCTYPE html>
<html>




<head>
  <title>Installing Stimulus | Finn's Web</title>
  <link href="https://alexfinnarn.github.io/css/main.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" crossorigin="anonymous">
  <link rel="icon" href="/finn.ico">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="Alex Finnarn has a grand plan. He does Drupal, JavaScript, PHP, DevOps, Unicorn, and has a nice music collection, as well.">
  <meta name="author" content="Alex Finnarn">
  
  <script type="module" src="/js/app.js" defer></script>
</head>
<body class="flex flex-col min-h-screen"><header class="bg-black text-white p-4">
  <nav class="md:max-w-screen-lg mx-auto flex flex-row justify-between align-baseline">
    <div class="space-x-2 divide-x-2 text-2xl md:text-xl mt-2">
      <a href="/">Thoughts</a>
      <a href="/yargh" class="pl-3">Yarghs</a>
    </div>
    <div class="flex flex-row space-x-4">
      <a href="https://github.com/alexfinnarn" aria-label="View my GitHub profile and code">
        <svg xmlns="http://www.w3.org/2000/svg" class="header-icons"
             viewBox="0 0 496 512">
          <path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/>
        </svg>
      </a>
      <a href="https://www.linkedin.com/in/alexfinnarn/" aria-label="View my LinkedIn profile and work history">
        <svg xmlns="http://www.w3.org/2000/svg" class="header-icons"
             viewBox="0 0 448 512">
          <path d="M100.28 448H7.4V148.9h92.88zM53.79 108.1C24.09 108.1 0 83.5 0 53.8a53.79 53.79 0 0 1 107.58 0c0 29.7-24.1 54.3-53.79 54.3zM447.9 448h-92.68V302.4c0-34.7-.7-79.2-48.29-79.2-48.29 0-55.69 37.7-55.69 76.7V448h-92.78V148.9h89.08v40.8h1.3c12.4-23.5 42.69-48.3 87.88-48.3 94 0 111.28 61.9 111.28 142.3V448z"/>
        </svg>
      </a>
      <a href="https://twitter.com/alexfinnarn" aria-label="View my Twitter profile and dumb sayings">
        <svg xmlns="http://www.w3.org/2000/svg" class="header-icons"
             viewBox="0 0 512 512">
          <path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/>
        </svg>
      </a>
    </div>
  </nav>
</header>
<div id="content" class="flex-grow">
<main id="main" class="link-blue-underline">
  <div class="bg-blue-700 relative shadow bg-blend-hue bg-opacity-95"
       style="background-image: url('https://www.educationquizzes.com/library/KS2-Geography/The-World-Main-Earth.jpg')">
    <div class="md:max-w-screen-md mx-auto flex flex-col-reverse h-64">
      <h1 id="title" class="text-4xl text-white pl-4 md:pl-0">Installing Stimulus</h1>
    </div>
  </div>
  <div class="md:max-w-screen-md mx-auto p-4">
    <article id="content">
      <p>It doesn&rsquo;t take long while building out a website before you end up needing to code up user
interaction, usually via clicking on an element. Before reaching for React or Vue, you can start
out with vanilla JS to quickly add an event listener.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#a6e22e">myElement</span>.<span style="color:#a6e22e">addEventListener</span>(<span style="color:#e6db74">&#39;click&#39;</span>, () =&gt; <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#39;hello world&#39;</span>))
</code></pre></div><p>But then you need to make sure the listener gets attached and detached from each element. This is a
task most people delegate to Vue or React where special template syntax allows you to call a
function when the user clicks on an element. Vue or React then translates the click behavior
from the Virtual DOM to the actual DOM. I know I&rsquo;m probably not the only one whose been caught
with a ghost event listener bug before due to improperly detaching an event in component garbage
collection.</p>
<p>Vue is better than React as far as standards go, but you still end up heading down the path
towards a very involved approach for such simple user behavior. In projects where the user
clicks around and fills out forms, it always felt like overkill for me to add a frontend
framework. I think the heft also contributes to &ldquo;decoupled&rdquo; seeming like a good idea, but that&rsquo;s
a story for another day.</p>
<p>What if you didn&rsquo;t need a build system and solely wanted a framework to attach a bit of behavior to
HTML you already generated with a server?</p>
<h2 id="enter-stimulus">Enter Stimulus</h2>
<blockquote>
<p>A modest JavaScript framework for the HTML you already have.</p>
</blockquote>
<p>Stimulus targets the developers interested in maintaining server-side control of
HTML markup. They come with a &ldquo;thin client&rdquo; mindset and are thrilled to try out a framework that
barely appears to be a framework at all. I am part of that target audience.</p>
<p>I will say that Stimulus has a way to go in providing great documentation that everyone
can use to incorporate it into their project. By reading <a href="https://stimulus.hotwired.dev/handbook/installing">the closest documentation I could find
relating to installation</a> I got a sense on
how I might go about adding it to this site, but I would have liked a some kind of tutorial to
go along with the examples. I&rsquo;ll get into open source documentation best practices in other
posts, but outside the few examples in their guide, you&rsquo;ll be left piecing together knowledge
from various blog posts.</p>
<h2 id="import-at-the-head">Import at the Head</h2>
<p>In these crazy times of modern browsers, you can now import modules straight into your HTML
documents. Coming from the <code>yarn add my-package</code> side of things, I find it refreshing to import
external code right into the place where you use it without the need for a centralized package
manager. I&rsquo;m not sure tree shaking or other kinds of optimizations can be handled without a
build system, but for my blog, I&rsquo;ll only be using a couple of dependencies, so I&rsquo;m not too
worried about performance differences.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">  <span style="color:#75715e">&lt;!-- Import Stimulus script in layouts/partials/head.html --&gt;</span>
  &lt;<span style="color:#f92672">script</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;module&#34;</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/app.js&#34;</span> <span style="color:#a6e22e">defer</span>&gt;&lt;/<span style="color:#f92672">script</span>&gt;
&lt;/<span style="color:#f92672">head</span>&gt;
</code></pre></div><p>By specifying the type as <code>module</code>, the browser allows you to include JS that looks like any
you&rsquo;d write in a frontend project. The file I&rsquo;m importing simply declares a default class export
with a simple <code>connect()</code> lifecycle method.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">Controller</span>, <span style="color:#a6e22e">Application</span> } 
  <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#34;https://unpkg.com/@hotwired/stimulus/dist/stimulus.js&#34;</span>;
<span style="color:#66d9ef">export</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">HelloController</span> <span style="color:#66d9ef">extends</span> <span style="color:#a6e22e">Controller</span> {
  <span style="color:#a6e22e">connect</span>() {
    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#39;Hello Gerald!&#39;</span>);
  }
}
window.<span style="color:#a6e22e">Stimulus</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Application</span>.<span style="color:#a6e22e">start</span>();
<span style="color:#a6e22e">Stimulus</span>.<span style="color:#a6e22e">register</span>(<span style="color:#e6db74">&#34;hello&#34;</span>, <span style="color:#a6e22e">HelloController</span>);
</code></pre></div><p>By using a CDN, we offload the loading of heavier JS resources to the vendors who are good at
serving them up. I&rsquo;m not going to try and extol the virtues of including code this way without
using any bundle system, but I can appreciate the simplicity of it all.</p>
<p>Now, whenever any HTML element with the attribute <code>data-controller=&quot;hello&quot;</code> loads, the <code>connect</code>
function runs and &ldquo;Hello Gerald!&rdquo; is printed in the console. Gerald, what a guy&hellip;do you know one?</p>
<p>I think it&rsquo;s swell I don&rsquo;t have to concern myself with attaching the JS and only what needs to
happen with each instance on the screen. Frameworks like React and Vue are great for providing
ways to interact with elements in succinct syntax, and Stimulus borrows from Vue in the syntax used
to tie user behavior to callbacks.</p>
<h2 id="revealing-the-factory-of-sadness">Revealing the Factory of Sadness</h2>
<p>Technically, we&rsquo;ve installed Stimulus in a two-step process: including a script tag in the head
of the document and initializing Stimulus and registering a controller in another script. I
could stop writing here and still fulfill the promise of this post&rsquo;s title, but what would you
really have learned then? So let&rsquo;s reveal a factory of sadness that I can
admit to visiting at least a couple of times, drinking, screaming, and leaving in&hellip;sadness.</p>
<p>While building my terribly-styled homepage, I got the idea to reveal the YouTube video when a
user clicks on a &ldquo;Reveal the Factory of Sadness &ndash;&gt;&rdquo; link. Juvenile, I know, but I have to fill
all the pretty boxes I wanted to include on my homepage somehow.</p>
<p>We need to let Stimulus know that a click on one element will replace the content of another
element. With the tagline of &ldquo;use the HTML you already have&rdquo;, you might guess that we won&rsquo;t
declare the behavior in JavaScript. Nope, Stimulus has a much simpler way of reading HTML
attributes to register event listeners while connecting to the HTML.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">&lt;<span style="color:#f92672">main</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;home-grid md:max-w-screen-4xl mx-auto&#34;</span>
      <span style="color:#a6e22e">data-controller</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;homepage&#34;</span>&gt;
  &lt;<span style="color:#f92672">a</span> <span style="color:#a6e22e">data-action</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;click-&gt;homepage#revealSadness&#34;</span>&gt;
    Reveal the Factory of Sadness -&gt;
  &lt;/<span style="color:#f92672">a</span>&gt;
</code></pre></div><p>The anchor element declares that when a user clicks it, Stimulus should find a <code>revealSadness</code>
method in the <code>homepage</code> controller. I think it&rsquo;s very semantic and fits the style I came to
know in Rails with controllers and actions.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">HomepageController</span> <span style="color:#66d9ef">extends</span> <span style="color:#a6e22e">Controller</span> {
  <span style="color:#66d9ef">static</span> <span style="color:#a6e22e">targets</span> <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;theater&#39;</span>];
  <span style="color:#a6e22e">revealSadness</span>() {
    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">theaterTarget</span>.<span style="color:#a6e22e">innerHTML</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">`    
</span><span style="color:#e6db74">    &lt;div class=&#34;shadow-xl w-full h-full&#34;&gt;
</span><span style="color:#e6db74">      &lt;iframe src=&#34;https://www.youtube.com/embed/tRBDMMVctu8&#34;
</span><span style="color:#e6db74">              title=&#34;The factory of sadness&#34;
</span><span style="color:#e6db74">              allowFullScreen&gt;&lt;/iframe&gt;
</span><span style="color:#e6db74">    &lt;/div&gt;`</span>;
  }
}
</code></pre></div><p>In the actual controller, the <code>revealSadness</code> function simply replaces the inner HTML of an
element target with a YouTube video embed.</p>
<p>The <code>static</code> keyword might jump out to you as it did me. This simply means that each instance of
the class will have a &ldquo;targets&rdquo; property that you can call directly instead of having to
instantiate a class first. I&rsquo;m not sure what Stimulus does internally with the static properties,
but it probably helps with caching and/or cloning when new elements appear in the DOM.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">&lt;<span style="color:#f92672">div</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;curtains centered md:h-64 lg:h-auto&#34;</span>
   <span style="color:#a6e22e">data-homepage-target</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;theater&#34;</span>
   <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;theater&#34;</span>&gt;
&lt;/<span style="color:#f92672">div</span>&gt;
</code></pre></div><p>All we have to do then is connect the <code>theaterTarget</code> with an element on the page with a
specifically named HTML attribute. You&rsquo;ll notice naming conventions throughout Stimulus, which
reminds me of Rails again, and in this case we have to prefix with <code>data-</code>, provide the name of
the controller <code>homepage</code>, and declare this a <code>-target</code> with the name <code>theater</code>: hence using
<code>theaterTarget</code> in the controller code.</p>
<p>After wiring this all up, I now have a way to fire a callback for any event that might happen.
We&rsquo;ll get into more complicated ways to interact in future posts, but since clicking is most of
what users do on the web, I think it&rsquo;s amazing that we now have such a simple, but structured
way to go about our business using web standards and not framework abstractions.</p>

    </article>
    <a href="/">&lt;-- Back to Home Base</a>
  </div>
</main>

        </div><footer class="bg-black p-4">
  2021c
</footer>
</body>
</html>
